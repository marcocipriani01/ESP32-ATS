<!DOCTYPE html>
<html lang="it-IT">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32-ATS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ace-builds@1.22.0/css/ace.min.css">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <style>
        .led-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
        }

        .led-green {
            background-color: green;
        }

        .led-red {
            background-color: red;
        }

        p {
            margin-left: 1em;
        }

        h1 {
            margin-top: 0.2em;
            margin-bottom: 0.5em;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Dashboard ESP32-ATS</h1>

        <div class="row">
            <div class="col-md-4">
                <h3>Carica batterie</h3>
                <p id="soc">0%, 0V</p>
            </div>
            <div class="col-md-4">
                <h3>Potenza ergogata</h3>
                <p id="power">0W (0A)</p>
            </div>
            <div class="col-md-4">
                <h3>Andamento tensione</h3>
                <p id="soc-dt">+0%/h, +0V/h</p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <h3>Abilitazione inverter</h3>
                <div id="ats-state"></div>
            </div>
            <div class="col-md-4">
                <h3>Relè attivo da</h3>
                <p id="ats-uptime">0h</p>
            </div>
            <div class="col-md-4">
                <h3>Presenza rete</h3>
                <div id="grid"></div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <h3>Temperatura</h3>
                <p id="ntc">0±0 °C</p>
            </div>
            <div class="col-md-4">
                <h3>Ventola</h3>
                <div id="fan"></div>
            </div>
            <div class="col-md-4">
                <h3>Sensori fuoco</h3>
                <div id="flame"></div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <h3>IP ESP32</h3>
                <p id="ip-address">192.168.0.0</p>
            </div>
            <div class="col-md-4">
                <h3>Uptime ESP32</h3>
                <p id="uptime">0h 0m</p>
            </div>
            <div class="col-md-4">
                <button id="clear-errors" class="btn btn-danger">Azzera errori</button>
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-md-12">
                <h3>Configurazione JSON</h3>
                <div id="json-editor" style="height: 300px; width: 100%;"></div>
            </div>
        </div>

        <div class="row" style="margin-top: 0.5em">
            <div class="col-md-12">
                <button id="save-button" class="btn btn-primary">Salva</button>
            </div>
        </div>

        <hr>

        <div class="row" style="margin-top: 0.5em">
            <div class="col-md-3">
                <button id="save-button" class="btn btn-warning">Aggiornamento firmware</button>
            </div>

            <div class="col-md-8">
                <p id="uptime">Firmware v1.0, 00/00/0000</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/ace-builds@1.22.0/src-min-noconflict/ace.min.js"></script>
    <script>
        var editor = ace.edit("json-editor");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/json");
    </script>

    <script>
        // Function to update the displayed stats (voltage, current, relay state)
        function updateStats() {
            // Replace the following lines with your own logic to retrieve the actual values
            const voltageValue = 100;
            const currentValue = 5;

            document.getElementById('voltage').textContent = voltageValue + 'V';
            document.getElementById('current').textContent = currentValue + 'A';

            const relayStateValue = 'On';
            const relayIndicator = document.getElementById('relay-indicator');

            if (relayStateValue === 'On') {
                relayIndicator.className = 'led-indicator led-green'; // Set the appropriate class for the green LED
            } else {
                relayIndicator.className = 'led-indicator led-red'; // Set the appropriate class for the red LED
            }
        }

        // Function to handle the save button click event
        function handleSaveButtonClick() {
            const jsonContent = document.getElementById('json-editor').value;
            // Replace the following line with your own logic to save the JSON content
            console.log('Saving JSON content:', jsonContent);
        }

        // Function to handle the reset button click event
        function handleResetButtonClick() {
            document.getElementById('json-editor').value = '';
        }

        // Update the stats on page load
        updateStats();

        // Attach event listeners
        document.getElementById('save-button').addEventListener('click', handleSaveButtonClick);
        document.getElementById('reset-button').addEventListener('click', handleResetButtonClick);
    </script>

</body>

</html>